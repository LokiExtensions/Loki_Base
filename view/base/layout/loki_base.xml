<?xml version="1.0"?>
<page xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:noNamespaceSchemaLocation="urn:magento:framework:View/Layout/etc/page_configuration.xsd">
    <body>
        <referenceContainer name="page.messages">
            <block
                name="loki.messages"
                template="Loki_Base::component/messages.phtml"
                before="-">
            </block>
        </referenceContainer>

        <referenceContainer name="before.body.end">
            <container name="loki.dynamic-script">
                <block name="loki.dynamic-script.variables" template="Loki_Base::script/variables.phtml">
                    <arguments>
                        <argument name="form_key_value" xsi:type="object">Loki\Base\ViewModel\FormKeyValue</argument>
                    </arguments>
                </block>
            </container>

            <block
                name="loki.script"
                class="Loki\Base\Block\LokiScript"
                template="Loki_Base::script/script-container.phtml">

                <block name="loki.alpinejs" template="Loki_Base::script/alpine-csp.phtml"/>

                <block name="loki.script.cookies" template="Loki_Base::script/cookies.phtml">
                    <arguments>
                        <argument name="cookie_config" xsi:type="object">Loki\Base\ViewModel\CookieConfig</argument>
                    </arguments>
                </block>
            </block>

            <block
                name="loki.script.store"
                class="Loki\Base\Block\LokiScript"
                template="Loki_Base::script/script-container.phtml">

                <block name="loki.script.store.local-storage" template="Loki_Base::script/store/localstorage-store.phtml">
                    <arguments>
                        <argument name="section_config" xsi:type="object">Loki\Base\ViewModel\SectionConfig</argument>
                    </arguments>
                </block>

                <block name="loki.script.store.messages" template="Loki_Base::script/store/message-store.phtml"/>
            </block>

            <block
                name="loki.script.directive"
                class="Loki\Base\Block\LokiScript"
                template="Loki_Base::script/script-container.phtml">

                <block name="loki.script.directive.autoremove" template="Loki_Base::script/directive/autoremove-directive.phtml"/>
            </block>

            <block
                name="loki.script.component-partial"
                class="Loki\Base\Block\LokiScript"
                template="Loki_Base::script/script-container.phtml">
            </block>

            <block
                name="loki.script.component-type"
                class="Loki\Base\Block\LokiScript"
                template="Loki_Base::script/script-container.phtml">
            </block>

            <block
                name="loki.script.component"
                class="Loki\Base\Block\LokiScript"
                template="Loki_Base::script/script-container.phtml">

                <block name="loki.component.messages" template="Loki_Base::script/component/message-component.phtml">
                    <arguments>
                        <argument name="config" xsi:type="object">Loki\Base\Config\Config</argument>
                    </arguments>
                </block>
            </block>
        </referenceContainer>
    </body>
</page>
