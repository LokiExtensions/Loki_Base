<?xml version="1.0"?>
<page xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:noNamespaceSchemaLocation="urn:magento:framework:View/Layout/etc/page_configuration.xsd">
    <update handle="loki_alpinejs"/>
    <update handle="loki_localstorage"/>
    <update handle="loki_messages"/>

    <body>
        <referenceContainer name="before.body.end">
            <container name="loki.dynamic-script">
                <block name="loki.dynamic-script.variables" template="Loki_Base::script/variables.phtml">
                    <arguments>
                        <argument name="form_key_value" xsi:type="object">Loki\Base\ViewModel\FormKeyValue</argument>
                        <argument name="locale_code" xsi:type="object">Loki\Base\ViewModel\LocaleCode</argument>
                    </arguments>
                </block>
            </container>

            <block
                name="loki.script"
                class="Loki\Base\Block\LokiScript"
                template="Loki_Base::script/script-container.phtml">

                <block name="loki.script.cookies" template="Loki_Base::script/cookies.phtml">
                    <arguments>
                        <argument name="cookie_config" xsi:type="object">Loki\Base\ViewModel\CookieConfig</argument>
                        <argument name="module_config" xsi:type="object">Loki\Base\ViewModel\ModuleConfig</argument>
                    </arguments>
                </block>
            </block>

            <block
                name="loki.script.store"
                class="Loki\Base\Block\LokiScript"
                template="Loki_Base::script/script-container.phtml">
            </block>

            <block
                name="loki.script.directive"
                class="Loki\Base\Block\LokiScript"
                template="Loki_Base::script/script-container.phtml">

                <block name="loki.script.directive.autoremove" template="Loki_Base::script/directive/autoremove-directive.phtml"/>
            </block>

            <block
                name="loki.script.component-partial"
                class="Loki\Base\Block\LokiScript"
                template="Loki_Base::script/script-container.phtml">
            </block>

            <block
                name="loki.script.component-type"
                class="Loki\Base\Block\LokiScript"
                template="Loki_Base::script/script-container.phtml">
            </block>

            <block
                after="-"
                name="loki.script.component"
                class="Loki\Base\Block\LokiScript"
                template="Loki_Base::script/script-container.phtml">
            </block>
        </referenceContainer>
    </body>
</page>
